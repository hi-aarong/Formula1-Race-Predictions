# -*- coding: utf-8 -*-
"""data_pull.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1y4qRXdqxpvOUn_CYAcSO9NnfQ6ch_1GT
"""

## install dependencies
!pip install fastf1
import fastf1
import fastf1.plotting
import pandas as pd
import seaborn as sns
from matplotlib import pyplot as plt
from datetime import datetime

def recieve_csv(year, location):
    ##Get session data
    race=fastf1.get_session(year, location, 'R')
    race.load()

    ##Get Qualifying Times
    qualifying=fastf1.get_session(year, location, 'Q')
    qualifying.load()
    qualifying_data = pd.DataFrame(qualifying.results)
    qualifying_data.to_csv(f'{location}_{year}_qualifying_data.csv')

    ##Returns race.results to csv
    results=pd.DataFrame(race.results)
    results.to_csv(f'{location}_{year}_results.csv')

    ##Returns race.laps to csv
    laps=pd.DataFrame(race.laps)
    laps.to_csv(f'{location}_{year}_laps.csv')

    ##Returns race.car_data for all drivers to csv
    drivers=[race.get_driver(i)["DriverNumber"] for i in race.drivers]
    for driver in drivers:
      race_data=pd.DataFrame(race.car_data[driver])
      race_data.to_csv(f'{location}_{year}_{race.get_driver(driver)["Abbreviation"]}_race_data.csv')



##Example
recieve_csv(2024, 'Monza')

|##Returns all race.results, race.laps and race.car_data as csv

schedule = fastf1.get_event_schedule(2024)
for event in schedule.itertuples():
  if event.EventDate < datetime.now() and event.EventFormat == "conventional":
    Recieve_csv(2024, event.Location)

fastf1.get_event_schedule(2024)



qualifying=fastf1.get_session(year, location, 'Q')
qualifying.load()
    qualifying_data=pd.DataFrame(qualifying)
    qualifying_data.to_csv(f'{location}_{year}_qualifying_data.csv')